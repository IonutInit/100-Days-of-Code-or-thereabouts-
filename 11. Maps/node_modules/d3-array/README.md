# d3-array

Data in JavaScript is often represented by an iterable (such as an [array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global\_Objects/Array), [set](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global\_Objects/Set) or [generator](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global\_Objects/Generator)), and so iterable manipulation is a common task when analyzing or visualizing data. For example, you might take a contiguous slice (subset) of an array, filter an array using a predicate function, or map an array to a parallel set of values using a transform function. Before looking at the methods that d3-array provides, familiarize yourself with the powerful [array methods built-in to JavaScript](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global\_Objects/Array).

JavaScript includes **mutation methods** that modify the array:

* [_array_.pop](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global\_Objects/Array/pop) - Remove the last element from the array.
* [_array_.push](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global\_Objects/Array/push) - Add one or more elements to the end of the array.
* [_array_.reverse](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global\_Objects/Array/reverse) - Reverse the order of the elements of the array.
* [_array_.shift](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global\_Objects/Array/shift) - Remove the first element from the array.
* [_array_.sort](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global\_Objects/Array/sort) - Sort the elements of the array.
* [_array_.splice](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global\_Objects/Array/splice) - Add or remove elements from the array.
* [_array_.unshift](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global\_Objects/Array/unshift) - Add one or more elements to the front of the array.

There are also **access methods** that return some representation of the array:

* [_array_.concat](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global\_Objects/Array/concat) - Join the array with other array(s) or value(s).
* [_array_.join](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global\_Objects/Array/join) - Join all elements of the array into a string.
* [_array_.slice](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global\_Objects/Array/slice) - Extract a section of the array.
* [_array_.indexOf](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global\_Objects/Array/indexOf) - Find the first occurrence of a value within the array.
* [_array_.lastIndexOf](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global\_Objects/Array/lastIndexOf) - Find the last occurrence of a value within the array.

And finally **iteration methods** that apply functions to elements in the array:

* [_array_.filter](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global\_Objects/Array/filter) - Create a new array with only the elements for which a predicate is true.
* [_array_.forEach](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global\_Objects/Array/forEach) - Call a function for each element in the array.
* [_array_.every](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global\_Objects/Array/every) - See if every element in the array satisfies a predicate.
* [_array_.map](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global\_Objects/Array/map) - Create a new array with the result of calling a function on every element in the array.
* [_array_.some](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global\_Objects/Array/some) - See if at least one element in the array satisfies a predicate.
* [_array_.reduce](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global\_Objects/Array/reduce) - Apply a function to reduce the array to a single value (from left-to-right).
* [_array_.reduceRight](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global\_Objects/Array/reduceRight) - Apply a function to reduce the array to a single value (from right-to-left).

## Installing

If you use npm, `npm install d3-array`. You can also download the [latest release on GitHub](https://github.com/d3/d3-array/releases/latest). For vanilla HTML in modern browsers, import d3-array from Skypack:

```html
<script type="module">

import {min} from "https://cdn.skypack.dev/d3-array@3";

const m = min(array);

</script>
```

For legacy environments, you can load d3-array’s UMD bundle from an npm-based CDN such as jsDelivr; a `d3` global is exported:

```html
<script src="https://cdn.jsdelivr.net/npm/d3-array@3"></script>
<script>

const m = d3.min(array);

</script>
```

## API Reference

* [Statistics](./#statistics)
* [Search](./#search)
* [Transformations](./#transformations)
* [Iterables](./#iterables)
* [Sets](./#sets)
* [Bins](./#bins)
* [Interning](./#interning)

### Statistics

Methods for computing basic summary statistics.

[#](./#min) d3.min(_iterable_\[, _accessor_]) · [Source](https://github.com/d3/d3-array/blob/main/src/min.js), [Examples](https://observablehq.com/@d3/d3-extent)

Returns the minimum value in the given _iterable_ using natural order. If the iterable contains no comparable values, returns undefined. An optional _accessor_ function may be specified, which is equivalent to calling Array.from before computing the minimum value.

Unlike the built-in [Math.min](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global\_Objects/Math/min), this method ignores undefined, null and NaN values; this is useful for ignoring missing data. In addition, elements are compared using natural order rather than numeric order. For example, the minimum of the strings \[“20”, “3”] is “20”, while the minimum of the numbers \[20, 3] is 3.

See also [extent](./#extent).

[#](./#minIndex) d3.minIndex(_iterable_\[, _accessor_]) · [Source](https://github.com/d3/d3-array/blob/main/src/minIndex.js), [Examples](https://observablehq.com/@d3/d3-extent)

Returns the index of the minimum value in the given _iterable_ using natural order. If the iterable contains no comparable values, returns -1. An optional _accessor_ function may be specified, which is equivalent to calling Array.from before computing the minimum value.

Unlike the built-in [Math.min](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global\_Objects/Math/min), this method ignores undefined, null and NaN values; this is useful for ignoring missing data. In addition, elements are compared using natural order rather than numeric order. For example, the minimum of the strings \[“20”, “3”] is “20”, while the minimum of the numbers \[20, 3] is 3.

[#](./#max) d3.max(_iterable_\[, _accessor_]) · [Source](https://github.com/d3/d3-array/blob/main/src/max.js), [Examples](https://observablehq.com/@d3/d3-extent)

Returns the maximum value in the given _iterable_ using natural order. If the iterable contains no comparable values, returns undefined. An optional _accessor_ function may be specified, which is equivalent to calling Array.from before computing the maximum value.

Unlike the built-in [Math.max](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global\_Objects/Math/max), this method ignores undefined values; this is useful for ignoring missing data. In addition, elements are compared using natural order rather than numeric order. For example, the maximum of the strings \[“20”, “3”] is “3”, while the maximum of the numbers \[20, 3] is 20.

See also [extent](./#extent).

[#](./#maxIndex) d3.maxIndex(_iterable_\[, _accessor_]) · [Source](https://github.com/d3/d3-array/blob/main/src/maxIndex.js), [Examples](https://observablehq.com/@d3/d3-extent)

Returns the index of the maximum value in the given _iterable_ using natural order. If the iterable contains no comparable values, returns -1. An optional _accessor_ function may be specified, which is equivalent to calling Array.from before computing the maximum value.

Unlike the built-in [Math.max](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global\_Objects/Math/max), this method ignores undefined values; this is useful for ignoring missing data. In addition, elements are compared using natural order rather than numeric order. For example, the maximum of the strings \[“20”, “3”] is “3”, while the maximum of the numbers \[20, 3] is 20.

[#](./#extent) d3.extent(_iterable_\[, _accessor_]) · [Source](https://github.com/d3/d3-array/blob/main/src/extent.js), [Examples](https://observablehq.com/@d3/d3-extent)

Returns the [minimum](./#min) and [maximum](./#max) value in the given _iterable_ using natural order. If the iterable contains no comparable values, returns \[undefined, undefined]. An optional _accessor_ function may be specified, which is equivalent to calling Array.from before computing the extent.

[#](./#mode) d3.mode(_iterable_\[, _accessor_]) · [Source](https://github.com/d3/d3-array/blob/main/src/mode.js), [Examples](https://observablehq.com/@d3/d3-mode)

Returns the mode of the given _iterable_, _i.e._ the value which appears the most often. In case of equality, returns the first of the relevant values. If the iterable contains no comparable values, returns undefined. An optional _accessor_ function may be specified, which is equivalent to calling Array.from before computing the mode. This method ignores undefined, null and NaN values; this is useful for ignoring missing data.

[#](./#sum) d3.sum(_iterable_\[, _accessor_]) · [Source](https://github.com/d3/d3-array/blob/main/src/sum.js), [Examples](https://observablehq.com/@d3/d3-sum)

Returns the sum of the given _iterable_ of numbers. If the iterable contains no numbers, returns 0. An optional _accessor_ function may be specified, which is equivalent to calling Array.from before computing the sum. This method ignores undefined and NaN values; this is useful for ignoring missing data.

[#](./#mean) d3.mean(_iterable_\[, _accessor_]) · [Source](https://github.com/d3/d3-array/blob/main/src/mean.js), [Examples](https://observablehq.com/@d3/d3-mean-d3-median-and-friends)

Returns the mean of the given _iterable_ of numbers. If the iterable contains no numbers, returns undefined. An optional _accessor_ function may be specified, which is equivalent to calling Array.from before computing the mean. This method ignores undefined and NaN values; this is useful for ignoring missing data.

[#](./#median) d3.median(_iterable_\[, _accessor_]) · [Source](https://github.com/d3/d3-array/blob/main/src/median.js), [Examples](https://observablehq.com/@d3/d3-mean-d3-median-and-friends)

Returns the median of the given _iterable_ of numbers using the [R-7 method](https://en.wikipedia.org/wiki/Quantile#Estimating\_quantiles\_from\_a\_sample). If the iterable contains no numbers, returns undefined. An optional _accessor_ function may be specified, which is equivalent to calling Array.from before computing the median. This method ignores undefined and NaN values; this is useful for ignoring missing data.

[#](./#medianIndex) d3.medianIndex(_array_, _p_\[, _accessor_]) [Source](https://github.com/d3/d3-array/blob/main/src/median.js)

Similar to _median_, but returns the index of the element to the left of the median.

[#](./#cumsum) d3.cumsum(_iterable_\[, _accessor_]) · [Source](https://github.com/d3/d3-array/blob/main/src/cumsum.js), [Examples](https://observablehq.com/@d3/d3-cumsum)

Returns the cumulative sum of the given _iterable_ of numbers, as a Float64Array of the same length. If the iterable contains no numbers, returns zeros. An optional _accessor_ function may be specified, which is equivalent to calling Array.from before computing the cumulative sum. This method ignores undefined and NaN values; this is useful for ignoring missing data.

[#](./#quantile) d3.quantile(_iterable_, _p_\[, _accessor_]) · [Source](https://github.com/d3/d3-array/blob/main/src/quantile.js), [Examples](https://observablehq.com/@d3/d3-mean-d3-median-and-friends)

Returns the _p_-quantile of the given _iterable_ of numbers, where _p_ is a number in the range \[0, 1]. For example, the median can be computed using _p_ = 0.5, the first quartile at _p_ = 0.25, and the third quartile at _p_ = 0.75. This particular implementation uses the [R-7 method](http://en.wikipedia.org/wiki/Quantile#Quantiles\_of\_a\_population), which is the default for the R programming language and Excel. For example:

```js
var a = [0, 10, 30];
d3.quantile(a, 0); // 0
d3.quantile(a, 0.5); // 10
d3.quantile(a, 1); // 30
d3.quantile(a, 0.25); // 5
d3.quantile(a, 0.75); // 20
d3.quantile(a, 0.1); // 2
```

An optional _accessor_ function may be specified, which is equivalent to calling _array_.map(_accessor_) before computing the quantile.

[#](./#quantileIndex) d3.quantileIndex(_array_, _p_\[, _accessor_]) [Source](https://github.com/d3/d3-array/blob/main/src/quantile.js)

Similar to _quantile_, but returns the index to the left of _p_.

[#](./#quantileSorted) d3.quantileSorted(_array_, _p_\[, _accessor_]) · [Source](https://github.com/d3/d3-array/blob/main/src/quantile.js), [Examples](https://observablehq.com/@d3/d3-mean-d3-median-and-friends)

Similar to _quantile_, but expects the input to be a **sorted** _array_ of values. In contrast with _quantile_, the accessor is only called on the elements needed to compute the quantile.

[#](./#rank) d3.rank(_iterable_\[, _comparator_]) · [Source](https://github.com/d3/d3-array/blob/main/src/rank.js), [Examples](https://observablehq.com/@d3/rank)\
[#](./#rank) d3.rank(_iterable_\[, _accessor_])

Returns an array with the rank of each value in the _iterable_, _i.e._ the zero-based index of the value when the iterable is sorted. Nullish values are sorted to the end and ranked NaN. An optional _comparator_ or _accessor_ function may be specified; the latter is equivalent to calling _array_.map(_accessor_) before computing the ranks. If _comparator_ is not specified, it defaults to [ascending](./#ascending). Ties (equivalent values) all get the same rank, defined as the first time the value is found.

```js
d3.rank([{x: 1}, {}, {x: 2}, {x: 0}], d => d.x); // [1, NaN, 2, 0]
d3.rank(["b", "c", "b", "a"]); // [1, 3, 1, 0]
d3.rank([1, 2, 3], d3.descending); // [2, 1, 0]
```

[#](./#variance) d3.variance(_iterable_\[, _accessor_]) · [Source](https://github.com/d3/d3-array/blob/main/src/variance.js), [Examples](https://observablehq.com/@d3/d3-mean-d3-median-and-friends)

Returns an [unbiased estimator of the population variance](http://mathworld.wolfram.com/SampleVariance.html) of the given _iterable_ of numbers using [Welford’s algorithm](https://en.wikipedia.org/wiki/Algorithms\_for\_calculating\_variance#Welford's\_online\_algorithm). If the iterable has fewer than two numbers, returns undefined. An optional _accessor_ function may be specified, which is equivalent to calling Array.from before computing the variance. This method ignores undefined and NaN values; this is useful for ignoring missing data.

[#](./#deviation) d3.deviation(_iterable_\[, _accessor_]) · [Source](https://github.com/d3/d3-array/blob/main/src/deviation.js), [Examples](https://observablehq.com/@d3/d3-mean-d3-median-and-friends)

Returns the standard deviation, defined as the square root of the [bias-corrected variance](./#variance), of the given _iterable_ of numbers. If the iterable has fewer than two numbers, returns undefined. An optional _accessor_ function may be specified, which is equivalent to calling Array.from before computing the standard deviation. This method ignores undefined and NaN values; this is useful for ignoring missing data.

[#](./#fsum) d3.fsum(\[_values_]\[, _accessor_]) · [Source](https://github.com/d3/d3-array/blob/main/src/fsum.js), [Examples](https://observablehq.com/@d3/d3-fsum)

Returns a full precision summation of the given _values_.

```js
d3.fsum([.1, .1, .1, .1, .1, .1, .1, .1, .1, .1]); // 1
d3.sum([.1, .1, .1, .1, .1, .1, .1, .1, .1, .1]); // 0.9999999999999999
```

Although slower, d3.fsum can replace d3.sum wherever greater precision is needed. Uses [d3.Adder](./#adder).

[#](./#fcumsum) d3.fcumsum(\[_values_]\[, _accessor_]) · [Source](https://github.com/d3/d3-array/blob/main/src/fsum.js), [Examples](https://observablehq.com/@d3/d3-fcumsum)

Returns a full precision cumulative sum of the given _values_.

```js
d3.fcumsum([1, 1e-14, -1]); // [1, 1.00000000000001, 1e-14]
d3.cumsum([1, 1e-14, -1]); // [1, 1.00000000000001, 9.992e-15]
```

Although slower, d3.fcumsum can replace d3.cumsum when greater precision is needed. Uses [d3.Adder](./#adder).

[#](./#adder) new d3.Adder()

Creates a full precision adder for [IEEE 754](https://en.wikipedia.org/wiki/IEEE\_754) floating point numbers, setting its initial value to 0.

[#](./#adder\_add) _adder_.add(_number_)

Adds the specified _number_ to the adder’s current value and returns the adder.

[#](./#adder\_valueOf) _adder_.valueOf()

Returns the IEEE 754 double precision representation of the adder’s current value. Most useful as the short-hand notation `+adder`.

### Search

Methods for searching arrays for a specific element.

[#](./#least) d3.least(_iterable_\[, _comparator_]) · [Source](https://github.com/d3/d3-array/blob/main/src/least.js), [Examples](https://observablehq.com/@d3/d3-least)\
[#](./#least) d3.least(_iterable_\[, _accessor_])

Returns the least element of the specified _iterable_ according to the specified _comparator_ or _accessor_. If the given _iterable_ contains no comparable elements (_i.e._, the comparator returns NaN when comparing each element to itself), returns undefined. If _comparator_ is not specified, it defaults to [ascending](./#ascending). For example:

```js
const array = [{foo: 42}, {foo: 91}];
d3.least(array, (a, b) => a.foo - b.foo); // {foo: 42}
d3.least(array, (a, b) => b.foo - a.foo); // {foo: 91}
d3.least(array, a => a.foo); // {foo: 42}
```

This function is similar to [min](./#min), except it allows the use of a comparator rather than an accessor.

[#](./#leastIndex) d3.leastIndex(_iterable_\[, _comparator_]) · [Source](https://github.com/d3/d3-array/blob/main/src/leastIndex.js), [Examples](https://observablehq.com/@d3/d3-least)\
[#](./#leastIndex) d3.leastIndex(_iterable_\[, _accessor_])

Returns the index of the least element of the specified _iterable_ according to the specified _comparator_ or _accessor_. If the given _iterable_ contains no comparable elements (_i.e._, the comparator returns NaN when comparing each element to itself), returns -1. If _comparator_ is not specified, it defaults to [ascending](./#ascending). For example:

```js
const array = [{foo: 42}, {foo: 91}];
d3.leastIndex(array, (a, b) => a.foo - b.foo); // 0
d3.leastIndex(array, (a, b) => b.foo - a.foo); // 1
d3.leastIndex(array, a => a.foo); // 0
```

This function is similar to [minIndex](./#minIndex), except it allows the use of a comparator rather than an accessor.

[#](./#greatest) d3.greatest(_iterable_\[, _comparator_]) · [Source](https://github.com/d3/d3-array/blob/main/src/greatest.js), [Examples](https://observablehq.com/@d3/d3-least)\
[#](./#greatest) d3.greatest(_iterable_\[, _accessor_])

Returns the greatest element of the specified _iterable_ according to the specified _comparator_ or _accessor_. If the given _iterable_ contains no comparable elements (_i.e._, the comparator returns NaN when comparing each element to itself), returns undefined. If _comparator_ is not specified, it defaults to [ascending](./#ascending). For example:

```js
const array = [{foo: 42}, {foo: 91}];
d3.greatest(array, (a, b) => a.foo - b.foo); // {foo: 91}
d3.greatest(array, (a, b) => b.foo - a.foo); // {foo: 42}
d3.greatest(array, a => a.foo); // {foo: 91}
```

This function is similar to [max](./#max), except it allows the use of a comparator rather than an accessor.

[#](./#greatestIndex) d3.greatestIndex(_iterable_\[, _comparator_]) · [Source](https://github.com/d3/d3-array/blob/main/src/greatestIndex.js), [Examples](https://observablehq.com/@d3/d3-least)\
[#](./#greatestIndex) d3.greatestIndex(_iterable_\[, _accessor_])

Returns the index of the greatest element of the specified _iterable_ according to the specified _comparator_ or _accessor_. If the given _iterable_ contains no comparable elements (_i.e._, the comparator returns NaN when comparing each element to itself), returns -1. If _comparator_ is not specified, it defaults to [ascending](./#ascending). For example:

```js
const array = [{foo: 42}, {foo: 91}];
d3.greatestIndex(array, (a, b) => a.foo - b.foo); // 1
d3.greatestIndex(array, (a, b) => b.foo - a.foo); // 0
d3.greatestIndex(array, a => a.foo); // 1
```

This function is similar to [maxIndex](./#maxIndex), except it allows the use of a comparator rather than an accessor.

[#](./#bisectLeft) d3.bisectLeft(_array_, _x_\[, _lo_\[, _hi_]]) · [Source](https://github.com/d3/d3-array/blob/main/src/bisect.js)

Returns the insertion point for _x_ in _array_ to maintain sorted order. The arguments _lo_ and _hi_ may be used to specify a subset of the array which should be considered; by default the entire array is used. If _x_ is already present in _array_, the insertion point will be before (to the left of) any existing entries. The return value is suitable for use as the first argument to [splice](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global\_Objects/Array/splice) assuming that _array_ is already sorted. The returned insertion point _i_ partitions the _array_ into two halves so that all _v_ < _x_ for _v_ in _array_.slice(_lo_, _i_) for the left side and all _v_ >= _x_ for _v_ in _array_.slice(_i_, _hi_) for the right side.

[#](./#bisect) d3.bisect(_array_, _x_\[, _lo_\[, _hi_]]) · [Source](https://github.com/d3/d3-array/blob/main/src/bisect.js), [Examples](https://observablehq.com/@d3/d3-bisect)\
[#](./#bisectRight) d3.bisectRight(_array_, _x_\[, _lo_\[, _hi_]])

Similar to [bisectLeft](./#bisectLeft), but returns an insertion point which comes after (to the right of) any existing entries of _x_ in _array_. The returned insertion point _i_ partitions the _array_ into two halves so that all _v_ <= _x_ for _v_ in _array_.slice(_lo_, _i_) for the left side and all _v_ > _x_ for _v_ in _array_.slice(_i_, _hi_) for the right side.

[#](./#bisectCenter) d3.bisectCenter(_array_, _x_\[, _lo_\[, _hi_]]) · [Source](https://github.com/d3/d3-array/blob/main/src/bisect.js), [Examples](https://observablehq.com/@d3/multi-line-chart)

Returns the index of the value closest to _x_ in the given _array_ of numbers. The arguments _lo_ (inclusive) and _hi_ (exclusive) may be used to specify a subset of the array which should be considered; by default the entire array is used.

See [_bisector_.center](./#bisector\_center).

[#](./#bisector) d3.bisector(_accessor_) · [Source](https://github.com/d3/d3-array/blob/main/src/bisector.js)\
[#](./#bisector) d3.bisector(_comparator_)

Returns a new bisector using the specified _accessor_ or _comparator_ function. This method can be used to bisect arrays of objects instead of being limited to simple arrays of primitives. For example, given the following array of objects:

```js
var data = [
  {date: new Date(2011, 1, 1), value: 0.5},
  {date: new Date(2011, 2, 1), value: 0.6},
  {date: new Date(2011, 3, 1), value: 0.7},
  {date: new Date(2011, 4, 1), value: 0.8}
];
```

A suitable bisect function could be constructed as:

```js
var bisectDate = d3.bisector(function(d) { return d.date; }).right;
```

This is equivalent to specifying a comparator:

```js
var bisectDate = d3.bisector(function(d, x) { return d.date - x; }).right;
```

And then applied as _bisectDate_(_array_, _date_), returning an index. Note that the comparator is always passed the search value _x_ as the second argument. Use a comparator rather than an accessor if you want values to be sorted in an order different than natural order, such as in descending rather than ascending order.

[#](./#bisector\_left) _bisector_.left(_array_, _x_\[, _lo_\[, _hi_]]) · [Source](https://github.com/d3/d3-array/blob/main/src/bisector.js)

Equivalent to [bisectLeft](./#bisectLeft), but uses this bisector’s associated comparator.

[#](./#bisector\_right) _bisector_.right(_array_, _x_\[, _lo_\[, _hi_]]) · [Source](https://github.com/d3/d3-array/blob/main/src/bisector.js)

Equivalent to [bisectRight](./#bisectRight), but uses this bisector’s associated comparator.

[#](./#bisector\_center) _bisector_.center(_array_, _x_\[, _lo_\[, _hi_]]) · [Source](https://github.com/d3/d3-array/blob/main/src/bisector.js)

Returns the index of the closest value to _x_ in the given sorted _array_. This expects that the bisector’s associated accessor returns a quantitative value, or that the bisector’s associated comparator returns a signed distance; otherwise, this method is equivalent to _bisector_.left.

[#](./#quickselect) d3.quickselect(_array_, _k_, _left_ = 0, _right_ = _array_.length - 1, _compare_ = ascending) · [Source](https://github.com/d3/d3-array/blob/main/src/quickselect.js), [Examples](https://observablehq.com/@d3/d3-quickselect)

See [mourner/quickselect](https://github.com/mourner/quickselect/blob/master/README.md).

[#](./#ascending) d3.ascending(_a_, _b_) · [Source](https://github.com/d3/d3-array/blob/main/src/ascending.js), [Examples](https://observablehq.com/@d3/d3-ascending)

Returns -1 if _a_ is less than _b_, or 1 if _a_ is greater than _b_, or 0. This is the comparator function for natural order, and can be used in conjunction with the built-in [_array_.sort](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global\_Objects/Array/sort) method to arrange elements in ascending order. It is implemented as:

```js
function ascending(a, b) {
  return a == null || b == null ? NaN : a < b ? -1 : a > b ? 1 : a >= b ? 0 : NaN;
}
```

Note that if no comparator function is specified to the built-in sort method, the default order is lexicographic (alphabetical), not natural! This can lead to surprising behavior when sorting an array of numbers.

[#](./#descending) d3.descending(_a_, _b_) · [Source](https://github.com/d3/d3-array/blob/main/src/descending.js), [Examples](https://observablehq.com/@d3/d3-ascending)

Returns -1 if _a_ is greater than _b_, or 1 if _a_ is less than _b_, or 0. This is the comparator function for reverse natural order, and can be used in conjunction with the built-in array sort method to arrange elements in descending order. It is implemented as:

```js
function descending(a, b) {
  return a == null || b == null ? NaN : b < a ? -1 : b > a ? 1 : b >= a ? 0 : NaN;
}
```

Note that if no comparator function is specified to the built-in sort method, the default order is lexicographic (alphabetical), not natural! This can lead to surprising behavior when sorting an array of numbers.

### Transformations

Methods for transforming arrays and for generating new arrays.

[#](./#group) d3.group(_iterable_, _...keys_) · [Source](https://github.com/d3/d3-array/blob/main/src/group.js), [Examples](https://observablehq.com/@d3/d3-group-d3-rollup)

Groups the specified _iterable_ of values into an [InternMap](./#InternMap) from _key_ to array of value. For example, given some data:

```js
data = [
  {name: "jim",   amount: "34.0",   date: "11/12/2015"},
  {name: "carl",  amount: "120.11", date: "11/12/2015"},
  {name: "stacy", amount: "12.01",  date: "01/04/2016"},
  {name: "stacy", amount: "34.05",  date: "01/04/2016"}
]
```

To group the data by name:

```js
d3.group(data, d => d.name)
```

This produces:

```js
Map(3) {
  "jim" => Array(1)
  "carl" => Array(1)
  "stacy" => Array(2)
}
```

If more than one _key_ is specified, a nested InternMap is returned. For example:

```js
d3.group(data, d => d.name, d => d.date)
```

This produces:

```js
Map(3) {
  "jim" => Map(1) {
    "11/12/2015" => Array(1)
  }
  "carl" => Map(1) {
    "11/12/2015" => Array(1)
  }
  "stacy" => Map(1) {
    "01/04/2016" => Array(2)
  }
}
```

To convert a Map to an Array, use [Array.from](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global\_Objects/Array/from). For example:

```js
Array.from(d3.group(data, d => d.name))
```

This produces:

```js
[
  ["jim", Array(1)],
  ["carl", Array(1)],
  ["stacy", Array(2)]
]
```

You can also simultaneously convert the \[_key_, _value_] to some other representation by passing a map function to Array.from:

```js
Array.from(d3.group(data, d => d.name), ([key, value]) => ({key, value}))
```

This produces:

```js
[
  {key: "jim", value: Array(1)},
  {key: "carl", value: Array(1)},
  {key: "stacy", value: Array(2)}
]
```

[_selection_.data](https://github.com/d3/d3-selection/blob/main/README.md#selection\_data) accepts iterables directly, meaning that you can use a Map (or Set or other iterable) to perform a data join without first needing to convert to an array.

[#](./#groups) d3.groups(_iterable_, _...keys_) · [Source](https://github.com/d3/d3-array/blob/main/src/group.js), [Examples](https://observablehq.com/@d3/d3-group-d3-rollup)

Equivalent to [group](./#group), but returns nested arrays instead of nested maps.

[#](./#flatGroup) d3.flatGroup(_iterable_, _...keys_) · [Source](https://github.com/d3/d3-array/blob/main/src/group.js), [Examples](https://observablehq.com/@d3/d3-flatgroup)

Equivalent to [group](./#group), but returns a flat array of \[_key0_, _key1_, …, _values_] instead of nested maps.

[#](./#index) d3.index(_iterable_, _...keys_) · [Source](https://github.com/d3/d3-array/blob/main/src/group.js), [Examples](https://observablehq.com/@d3/d3-group)

Equivalent to [group](./#group) but returns a unique value per compound key instead of an array, throwing if the key is not unique.

For example, given the data defined above,

```js
d3.index(data, d => d.amount)
```

returns

```js
Map(4) {
  "34.0" => Object {name: "jim", amount: "34.0", date: "11/12/2015"}
  "120.11" => Object {name: "carl", amount: "120.11", date: "11/12/2015"}
  "12.01" => Object {name: "stacy", amount: "12.01", date: "01/04/2016"}
  "34.05" => Object {name: "stacy", amount: "34.05", date: "01/04/2016"}
}
```

On the other hand,

```js
d3.index(data, d => d.name)
```

throws an error because two objects share the same name.

[#](./#indexes) d3.indexes(_iterable_, _...keys_) · [Source](https://github.com/d3/d3-array/blob/main/src/group.js), [Examples](https://observablehq.com/@d3/d3-group)

Equivalent to [index](./#index), but returns nested arrays instead of nested maps.

[#](./#rollup) d3.rollup(_iterable_, _reduce_, _...keys_) · [Source](https://github.com/d3/d3-array/blob/main/src/group.js), [Examples](https://observablehq.com/@d3/d3-group-d3-rollup)

[Groups](./#group) and reduces the specified _iterable_ of values into an InternMap from _key_ to value. For example, given some data:

```js
data = [
  {name: "jim",   amount: "34.0",   date: "11/12/2015"},
  {name: "carl",  amount: "120.11", date: "11/12/2015"},
  {name: "stacy", amount: "12.01",  date: "01/04/2016"},
  {name: "stacy", amount: "34.05",  date: "01/04/2016"}
]
```

To count the number of elements by name:

```js
d3.rollup(data, v => v.length, d => d.name)
```

This produces:

```js
Map(3) {
  "jim" => 1
  "carl" => 1
  "stacy" => 2
}
```

If more than one _key_ is specified, a nested Map is returned. For example:

```js
d3.rollup(data, v => v.length, d => d.name, d => d.date)
```

This produces:

```js
Map(3) {
  "jim" => Map(1) {
    "11/12/2015" => 1
  }
  "carl" => Map(1) {
    "11/12/2015" => 1
  }
  "stacy" => Map(1) {
    "01/04/2016" => 2
  }
}
```

To convert a Map to an Array, use [Array.from](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global\_Objects/Array/from). See [d3.group](./#group) for examples.

[#](./#rollups) d3.rollups(_iterable_, _reduce_, _...keys_) · [Source](https://github.com/d3/d3-array/blob/main/src/group.js), [Examples](https://observablehq.com/@d3/d3-group-d3-rollup)

Equivalent to [rollup](./#rollup), but returns nested arrays instead of nested maps.

[#](./#flatRollup) d3.flatRollup(_iterable_, _reduce_, _...keys_) · [Source](https://github.com/d3/d3-array/blob/main/src/group.js), [Examples](https://observablehq.com/@d3/d3-flatgroup)

Equivalent to [rollup](./#rollup), but returns a flat array of \[_key0_, _key1_, …, _value_] instead of nested maps.

[#](./#groupSort) d3.groupSort(_iterable_, _comparator_, _key_) · [Source](https://github.com/d3/d3-array/blob/main/src/groupSort.js), [Examples](https://observablehq.com/@d3/d3-groupsort)\
[#](./#groupSort) d3.groupSort(_iterable_, _accessor_, _key_)

Groups the specified _iterable_ of elements according to the specified _key_ function, sorts the groups according to the specified _comparator_, and then returns an array of keys in sorted order. For example, if you had a table of barley yields for different varieties, sites, and years, to sort the barley varieties by ascending median yield:

```js
d3.groupSort(barley, g => d3.median(g, d => d.yield), d => d.variety)
```

For descending order, negate the group value:

```js
d3.groupSort(barley, g => -d3.median(g, d => d.yield), d => d.variety)
```

If a _comparator_ is passed instead of an _accessor_ (i.e., if the second argument is a function that takes exactly two arguments), it will be asked to compare two groups _a_ and _b_ and should return a negative value if _a_ should be before _b_, a positive value if _a_ should be after _b_, or zero for a partial ordering.

[#](./#count) d3.count(_iterable_\[, _accessor_]) · [Source](https://github.com/d3/d3-array/blob/main/src/count.js), [Examples](https://observablehq.com/@d3/d3-count)

Returns the number of valid number values (_i.e._, not null, NaN, or undefined) in the specified _iterable_; accepts an accessor.

For example:

```js
d3.count([{n: "Alice", age: NaN}, {n: "Bob", age: 18}, {n: "Other"}], d => d.age) // 1
```

[#](./#cross) d3.cross(_...iterables_\[, _reducer_]) · [Source](https://github.com/d3/d3-array/blob/main/src/cross.js), [Examples](https://observablehq.com/@d3/d3-cross)

Returns the [Cartesian product](https://en.wikipedia.org/wiki/Cartesian\_product) of the specified _iterables_. For example, if two iterables _a_ and _b_ are specified, for each element _i_ in the iterable _a_ and each element _j_ in the iterable _b_, in order, invokes the specified _reducer_ function passing the element _i_ and element _j_. If a _reducer_ is not specified, it defaults to a function which creates a two-element array for each pair:

```js
function pair(a, b) {
  return [a, b];
}
```

For example:

```js
d3.cross([1, 2], ["x", "y"]); // returns [[1, "x"], [1, "y"], [2, "x"], [2, "y"]]
d3.cross([1, 2], ["x", "y"], (a, b) => a + b); // returns ["1x", "1y", "2x", "2y"]
```

[#](./#merge) d3.merge(_iterables_) · [Source](https://github.com/d3/d3-array/blob/main/src/merge.js), [Examples](https://observablehq.com/@d3/d3-merge)

Merges the specified iterable of _iterables_ into a single array. This method is similar to the built-in array concat method; the only difference is that it is more convenient when you have an array of arrays.

```js
d3.merge([[1], [2, 3]]); // returns [1, 2, 3]
```

[#](./#pairs) d3.pairs(_iterable_\[, _reducer_]) · [Source](https://github.com/d3/d3-array/blob/main/src/pairs.js), [Examples](https://observablehq.com/@d3/d3-pairs)

For each adjacent pair of elements in the specified _iterable_, in order, invokes the specified _reducer_ function passing the element _i_ and element _i_ - 1. If a _reducer_ is not specified, it defaults to a function which creates a two-element array for each pair:

```js
function pair(a, b) {
  return [a, b];
}
```

For example:

```js
d3.pairs([1, 2, 3, 4]); // returns [[1, 2], [2, 3], [3, 4]]
d3.pairs([1, 2, 3, 4], (a, b) => b - a); // returns [1, 1, 1];
```

If the specified iterable has fewer than two elements, returns the empty array.

[#](./#permute) d3.permute(_source_, _keys_) · [Source](https://github.com/d3/d3-array/blob/main/src/permute.js), [Examples](https://observablehq.com/@d3/d3-permute)

Returns a permutation of the specified _source_ object (or array) using the specified iterable of _keys_. The returned array contains the corresponding property of the source object for each key in _keys_, in order. For example:

```js
permute(["a", "b", "c"], [1, 2, 0]); // returns ["b", "c", "a"]
```

It is acceptable to have more keys than source elements, and for keys to be duplicated or omitted.

This method can also be used to extract the values from an object into an array with a stable order. Extracting keyed values in order can be useful for generating data arrays in nested selections. For example:

```js
let object = {yield: 27, variety: "Manchuria", year: 1931, site: "University Farm"};
let fields = ["site", "variety", "yield"];

d3.permute(object, fields); // returns ["University Farm", "Manchuria", 27]
```

[#](./#shuffle) d3.shuffle(_array_\[, _start_\[, _stop_]]) · [Source](https://github.com/d3/d3-array/blob/main/src/shuffle.js), [Examples](https://observablehq.com/@d3/d3-shuffle)

Randomizes the order of the specified _array_ in-place using the [Fisher–Yates shuffle](https://bost.ocks.org/mike/shuffle/) and returns the _array_. If _start_ is specified, it is the starting index (inclusive) of the _array_ to shuffle; if _start_ is not specified, it defaults to zero. If _stop_ is specified, it is the ending index (exclusive) of the _array_ to shuffle; if _stop_ is not specified, it defaults to _array_.length. For example, to shuffle the first ten elements of the _array_: shuffle(_array_, 0, 10).

[#](./#shuffler) d3.shuffler(_random_) · [Source](https://github.com/d3/d3-array/blob/main/src/shuffle.js)

Returns a [shuffle function](./#shuffle) given the specified random source. For example, using [d3.randomLcg](https://github.com/d3/d3-random/blob/main/README.md#randomLcg):

```js
const random = d3.randomLcg(0.9051667019185816);
const shuffle = d3.shuffler(random);

shuffle([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]); // returns [7, 4, 5, 3, 9, 0, 6, 1, 2, 8]
```

[#](./#ticks) d3.ticks(_start_, _stop_, _count_) · [Source](https://github.com/d3/d3-array/blob/main/src/ticks.js), [Examples](https://observablehq.com/@d3/d3-ticks)

Returns an array of approximately _count_ + 1 uniformly-spaced, nicely-rounded values between _start_ and _stop_ (inclusive). Each value is a power of ten multiplied by 1, 2 or 5. See also [d3.tickIncrement](./#tickIncrement), [d3.tickStep](./#tickStep) and [_linear_.ticks](https://github.com/d3/d3-scale/blob/main/README.md#linear\_ticks).

Ticks are inclusive in the sense that they may include the specified _start_ and _stop_ values if (and only if) they are exact, nicely-rounded values consistent with the inferred [step](./#tickStep). More formally, each returned tick _t_ satisfies _start_ ≤ _t_ and _t_ ≤ _stop_.

[#](./#tickIncrement) d3.tickIncrement(_start_, _stop_, _count_) · [Source](https://github.com/d3/d3-array/blob/main/src/ticks.js), [Examples](https://observablehq.com/@d3/d3-ticks)

Like [d3.tickStep](./#tickStep), except requires that _start_ is always less than or equal to _stop_, and if the tick step for the given _start_, _stop_ and _count_ would be less than one, returns the negative inverse tick step instead. This method is always guaranteed to return an integer, and is used by [d3.ticks](./#ticks) to guarantee that the returned tick values are represented as precisely as possible in IEEE 754 floating point.

[#](./#tickStep) d3.tickStep(_start_, _stop_, _count_) · [Source](https://github.com/d3/d3-array/blob/main/src/ticks.js), [Examples](https://observablehq.com/@d3/d3-ticks)

Returns the difference between adjacent tick values if the same arguments were passed to [d3.ticks](./#ticks): a nicely-rounded value that is a power of ten multiplied by 1, 2 or 5. Note that due to the limited precision of IEEE 754 floating point, the returned value may not be exact decimals; use [d3-format](https://github.com/d3/d3-format) to format numbers for human consumption.

[#](./#nice) d3.nice(_start_, _stop_, _count_) · [Source](https://github.com/d3/d3-array/blob/main/src/nice.js)

Returns a new interval \[_niceStart_, _niceStop_] covering the given interval \[_start_, _stop_] and where _niceStart_ and _niceStop_ are guaranteed to align with the corresponding [tick step](./#tickStep). Like [d3.tickIncrement](./#tickIncrement), this requires that _start_ is less than or equal to _stop_.

[#](./#range) d3.range(\[_start_, ]_stop_\[, _step_]) · [Source](https://github.com/d3/d3-array/blob/main/src/range.js), [Examples](https://observablehq.com/@d3/d3-range)

Returns an array containing an arithmetic progression, similar to the Python built-in [range](http://docs.python.org/library/functions.html#range). This method is often used to iterate over a sequence of uniformly-spaced numeric values, such as the indexes of an array or the ticks of a linear scale. (See also [d3.ticks](./#ticks) for nicely-rounded values.)

If _step_ is omitted, it defaults to 1. If _start_ is omitted, it defaults to 0. The _stop_ value is exclusive; it is not included in the result. If _step_ is positive, the last element is the largest _start_ + _i_ \* _step_ less than _stop_; if _step_ is negative, the last element is the smallest _start_ + _i_ \* _step_ greater than _stop_. If the returned array would contain an infinite number of values, an empty range is returned.

The arguments are not required to be integers; however, the results are more predictable if they are. The values in the returned array are defined as _start_ + _i_ \* _step_, where _i_ is an integer from zero to one minus the total number of elements in the returned array. For example:

```js
d3.range(0, 1, 0.2) // [0, 0.2, 0.4, 0.6000000000000001, 0.8]
```

This unexpected behavior is due to IEEE 754 double-precision floating point, which defines 0.2 \* 3 = 0.6000000000000001. Use [d3-format](https://github.com/d3/d3-format) to format numbers for human consumption with appropriate rounding; see also [linear.tickFormat](https://github.com/d3/d3-scale/blob/main/README.md#linear\_tickFormat) in [d3-scale](https://github.com/d3/d3-scale).

Likewise, if the returned array should have a specific length, consider using [array.map](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global\_Objects/Array/map) on an integer range. For example:

```js
d3.range(0, 1, 1 / 49); // BAD: returns 50 elements!
d3.range(49).map(function(d) { return d / 49; }); // GOOD: returns 49 elements.
```

[#](./#transpose) d3.transpose(_matrix_) · [Source](https://github.com/d3/d3-array/blob/main/src/transpose.js), [Examples](https://observablehq.com/@d3/d3-transpose)

Uses the [zip](./#zip) operator as a two-dimensional [matrix transpose](http://en.wikipedia.org/wiki/Transpose).

[#](./#zip) d3.zip(_arrays…_) · [Source](https://github.com/d3/d3-array/blob/main/src/zip.js), [Examples](https://observablehq.com/@d3/d3-transpose)

Returns an array of arrays, where the _i_th array contains the _i_th element from each of the argument _arrays_. The returned array is truncated in length to the shortest array in _arrays_. If _arrays_ contains only a single array, the returned array contains one-element arrays. With no arguments, the returned array is empty.

```js
d3.zip([1, 2], [3, 4]); // returns [[1, 3], [2, 4]]
```

#### Blur

[#](./#blur) d3.blur(_data_, _radius_) · [Source](https://github.com/d3/d3-array/blob/main/src/blur.js), [Examples](https://observablehq.com/@d3/d3-blur)

Blurs an array of _data_ in-place by applying three iterations of a moving average transform, for a fast approximation of a gaussian kernel of the given _radius_, a non-negative number, and returns the array.

```js
const randomWalk = d3.cumsum({length: 1000}, () => Math.random() - 0.5);
blur(randomWalk, 5);
```

Copy the data if you don’t want to smooth it in-place:

```js
const smoothed = blur(randomWalk.slice(), 5);
```

[#](./#blur2) d3.blur2({_data_, _width_\[, _height_]}, _rx_\[, _ry_]) · [Source](https://github.com/d3/d3-array/blob/main/src/blur.js), [Examples](https://observablehq.com/@d3/d3-blur)

Blurs a matrix of the given _width_ and _height_ in-place, by applying an horizontal blur of radius _rx_ and a vertical blur or radius _ry_ (which defaults to _rx_). The matrix _data_ is stored in a flat array, used to determine the _height_ if it is not specified. Returns the blurred {data, width, height}.

```js
data = [
  1, 0, 0,
  0, 0, 0,
  0, 0, 1
];
blur2({data, width: 3}, 1);
```

[#](./#blurImage) d3.blurImage(_imageData_, _rx_\[, _ry_]) · [Source](https://github.com/d3/d3-array/blob/main/src/blur.js), [Examples](https://observablehq.com/@d3/d3-blurimage)

Blurs an [ImageData](https://developer.mozilla.org/en-US/docs/Web/API/ImageData) structure in-place, blurring each of the RGBA layers independently by applying an horizontal blur of radius _rx_ and a vertical blur or radius _ry_ (which defaults to _rx_). Returns the blurred ImageData.

```js
const imData = context.getImageData(0, 0, width, height);
blurImage(imData, 5);
```

### Iterables

These are equivalent to built-in array methods, but work with any iterable including Map, Set, and Generator.

[#](./#every) d3.every(_iterable_, _test_) · [Source](https://github.com/d3/d3-array/blob/main/src/every.js)

Returns true if the given _test_ function returns true for every value in the given _iterable_. This method returns as soon as _test_ returns a non-truthy value or all values are iterated over. Equivalent to [_array_.every](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global\_Objects/Array/every):

```js
d3.every(new Set([1, 3, 5, 7]), x => x & 1) // true
```

[#](./#some) d3.some(_iterable_, _test_) · [Source](https://github.com/d3/d3-array/blob/main/src/some.js)

Returns true if the given _test_ function returns true for any value in the given _iterable_. This method returns as soon as _test_ returns a truthy value or all values are iterated over. Equivalent to [_array_.some](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global\_Objects/Array/some):

```js
d3.some(new Set([0, 2, 3, 4]), x => x & 1) // true
```

[#](./#filter) d3.filter(_iterable_, _test_) · [Source](https://github.com/d3/d3-array/blob/main/src/filter.js)

Returns a new array containing the values from _iterable_, in order, for which the given _test_ function returns true. Equivalent to [_array_.filter](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global\_Objects/Array/filter):

```js
d3.filter(new Set([0, 2, 3, 4]), x => x & 1) // [3]
```

[#](./#map) d3.map(_iterable_, _mapper_) · [Source](https://github.com/d3/d3-array/blob/main/src/map.js)

Returns a new array containing the mapped values from _iterable_, in order, as defined by given _mapper_ function. Equivalent to [_array_.map](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global\_Objects/Array/map) and [Array.from](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global\_Objects/Array/from):

```js
d3.map(new Set([0, 2, 3, 4]), x => x & 1) // [0, 0, 1, 0]
```

[#](./#reduce) d3.reduce(_iterable_, _reducer_\[, _initialValue_]) · [Source](https://github.com/d3/d3-array/blob/main/src/reduce.js)

Returns the reduced value defined by given _reducer_ function, which is repeatedly invoked for each value in _iterable_, being passed the current reduced value and the next value. Equivalent to [_array_.reduce](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global\_Objects/Array/reduce):

```js
d3.reduce(new Set([0, 2, 3, 4]), (p, v) => p + v, 0) // 9
```

[#](./#reverse) d3.reverse(_iterable_) · [Source](https://github.com/d3/d3-array/blob/main/src/reverse.js)

Returns an array containing the values in the given _iterable_ in reverse order. Equivalent to [_array_.reverse](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global\_Objects/Array/reverse), except that it does not mutate the given _iterable_:

```js
d3.reverse(new Set([0, 2, 3, 1])) // [1, 3, 2, 0]
```

[#](./#sort) d3.sort(_iterable_, _comparator_ = d3.ascending) · [Source](https://github.com/d3/d3-array/blob/main/src/sort.js)\
[#](./#sort) d3.sort(_iterable_, ..._accessors_)

Returns an array containing the values in the given _iterable_ in the sorted order defined by the given _comparator_ or _accessor_ function. If _comparator_ is not specified, it defaults to [d3.ascending](./#ascending). Equivalent to [_array_.sort](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global\_Objects/Array/sort), except that it does not mutate the given _iterable_, and the comparator defaults to natural order instead of lexicographic order:

```js
d3.sort(new Set([0, 2, 3, 1])) // [0, 1, 2, 3]
```

If an _accessor_ (a function that does not take exactly two arguments) is specified,

```js
d3.sort(data, d => d.value)
```

it is equivalent to a _comparator_ using [natural order](./#ascending):

```js
d3.sort(data, (a, b) => d3.ascending(a.value, b.value))
```

The _accessor_ is only invoked once per element, and thus the returned sorted order is consistent even if the accessor is nondeterministic.

Multiple accessors may be specified to break ties:

```js
d3.sort(points, ({x}) => x, ({y}) => y)
```

This is equivalent to:

```js
d3.sort(data, (a, b) => d3.ascending(a.x, b.x) || d3.ascending(a.y, b.y))
```

### Sets

This methods implement basic set operations for any iterable.

[#](./#difference) d3.difference(_iterable_, ..._others_) · [Source](https://github.com/d3/d3-array/blob/main/src/difference.js)

Returns a new InternSet containing every value in _iterable_ that is not in any of the _others_ iterables.

```js
d3.difference([0, 1, 2, 0], [1]) // Set {0, 2}
```

[#](./#union) d3.union(..._iterables_) · [Source](https://github.com/d3/d3-array/blob/main/src/union.js)

Returns a new InternSet containing every (distinct) value that appears in any of the given _iterables_. The order of values in the returned set is based on their first occurrence in the given _iterables_.

```js
d3.union([0, 2, 1, 0], [1, 3]) // Set {0, 2, 1, 3}
```

[#](./#intersection) d3.intersection(..._iterables_) · [Source](https://github.com/d3/d3-array/blob/main/src/intersection.js)

Returns a new InternSet containing every (distinct) value that appears in all of the given _iterables_. The order of values in the returned set is based on their first occurrence in the given _iterables_.

```js
d3.intersection([0, 2, 1, 0], [1, 3]) // Set {1}
```

[#](./#superset) d3.superset(_a_, _b_) · [Source](https://github.com/d3/d3-array/blob/main/src/superset.js)

Returns true if _a_ is a superset of _b_: if every value in the given iterable _b_ is also in the given iterable _a_.

```js
d3.superset([0, 2, 1, 3, 0], [1, 3]) // true
```

[#](./#subset) d3.subset(_a_, _b_) · [Source](https://github.com/d3/d3-array/blob/main/src/subset.js)

Returns true if _a_ is a subset of _b_: if every value in the given iterable _a_ is also in the given iterable _b_.

```js
d3.subset([1, 3], [0, 2, 1, 3, 0]) // true
```

[#](./#disjoint) d3.disjoint(_a_, _b_) · [Source](https://github.com/d3/d3-array/blob/main/src/disjoint.js)

Returns true if _a_ and _b_ are disjoint: if _a_ and _b_ contain no shared value.

```js
d3.disjoint([1, 3], [2, 4]) // true
```

### Bins

[![Histogram](https://raw.githubusercontent.com/d3/d3-array/main/img/histogram.png)](http://bl.ocks.org/mbostock/3048450)

Binning groups discrete samples into a smaller number of consecutive, non-overlapping intervals. They are often used to visualize the distribution of numerical data as histograms.

[#](./#bin) d3.bin() · [Source](https://github.com/d3/d3-array/blob/main/src/bin.js), [Examples](https://observablehq.com/@d3/d3-bin)

Constructs a new bin generator with the default settings.

[#](./#\_bin) _bin_(_data_) · [Source](https://github.com/d3/d3-array/blob/main/src/bin.js), [Examples](https://observablehq.com/@d3/d3-bin)

Bins the given iterable of _data_ samples. Returns an array of bins, where each bin is an array containing the associated elements from the input _data_. Thus, the `length` of the bin is the number of elements in that bin. Each bin has two additional attributes:

* `x0` - the lower bound of the bin (inclusive).
* `x1` - the upper bound of the bin (exclusive, except for the last bin).

Any null or non-comparable values in the given _data_, or those outside the [domain](./#bin\_domain), are ignored.

[#](./#bin\_value) _bin_.value(\[_value_]) · [Source](https://github.com/d3/d3-array/blob/main/src/bin.js), [Examples](https://observablehq.com/@d3/d3-bin)

If _value_ is specified, sets the value accessor to the specified function or constant and returns this bin generator. If _value_ is not specified, returns the current value accessor, which defaults to the identity function.

When bins are [generated](./#\_bin), the value accessor will be invoked for each element in the input data array, being passed the element `d`, the index `i`, and the array `data` as three arguments. The default value accessor assumes that the input data are orderable (comparable), such as numbers or dates. If your data are not, then you should specify an accessor that returns the corresponding orderable value for a given datum.

This is similar to mapping your data to values before invoking the bin generator, but has the benefit that the input data remains associated with the returned bins, thereby making it easier to access other fields of the data.

[#](./#bin\_domain) _bin_.domain(\[_domain_]) · [Source](https://github.com/d3/d3-array/blob/main/src/bin.js), [Examples](https://observablehq.com/@d3/d3-bin)

If _domain_ is specified, sets the domain accessor to the specified function or array and returns this bin generator. If _domain_ is not specified, returns the current domain accessor, which defaults to [extent](./#extent). The bin domain is defined as an array \[_min_, _max_], where _min_ is the minimum observable value and _max_ is the maximum observable value; both values are inclusive. Any value outside of this domain will be ignored when the bins are [generated](./#\_bin).

For example, if you are using the bin generator in conjunction with a [linear scale](https://github.com/d3/d3-scale/blob/main/README.md#linear-scales) `x`, you might say:

```js
var bin = d3.bin()
    .domain(x.domain())
    .thresholds(x.ticks(20));
```

You can then compute the bins from an array of numbers like so:

```js
var bins = bin(numbers);
```

If the default [extent](./#extent) domain is used and the [thresholds](./#bin\_thresholds) are specified as a count (rather than explicit values), then the computed domain will be [niced](./#nice) such that all bins are uniform width.

Note that the domain accessor is invoked on the materialized array of [values](./#bin\_value), not on the input data array.

[#](./#bin\_thresholds) _bin_.thresholds(\[_count_]) · [Source](https://github.com/d3/d3-array/blob/main/src/bin.js), [Examples](https://observablehq.com/@d3/d3-bin)\
[#](./#bin\_thresholds) _bin_.thresholds(\[_thresholds_])

If _thresholds_ is specified, sets the [threshold generator](./#bin-thresholds) to the specified function or array and returns this bin generator. If _thresholds_ is not specified, returns the current threshold generator, which by default implements [Sturges’ formula](./#thresholdSturges). (Thus by default, the values to be binned must be numbers!) Thresholds are defined as an array of values \[_x0_, _x1_, …]. Any value less than _x0_ will be placed in the first bin; any value greater than or equal to _x0_ but less than _x1_ will be placed in the second bin; and so on. Thus, the [generated bins](./#\_bin) will have _thresholds_.length + 1 bins. See [bin thresholds](./#bin-thresholds) for more information.

Any threshold values outside the [domain](./#bin\_domain) are ignored. The first _bin_.x0 is always equal to the minimum domain value, and the last _bin_.x1 is always equal to the maximum domain value.

If a _count_ is specified instead of an array of _thresholds_, then the [domain](./#bin\_domain) will be uniformly divided into approximately _count_ bins; see [ticks](./#ticks).

#### Bin Thresholds

These functions are typically not used directly; instead, pass them to [_bin_.thresholds](./#bin\_thresholds).

[#](./#thresholdFreedmanDiaconis) d3.thresholdFreedmanDiaconis(_values_, _min_, _max_) · [Source](https://github.com/d3/d3-array/blob/main/src/threshold/freedmanDiaconis.js), [Examples](https://observablehq.com/@d3/d3-bin)

Returns the number of bins according to the [Freedman–Diaconis rule](https://en.wikipedia.org/wiki/Histogram#Mathematical\_definition); the input _values_ must be numbers.

[#](./#thresholdScott) d3.thresholdScott(_values_, _min_, _max_) · [Source](https://github.com/d3/d3-array/blob/main/src/threshold/scott.js), [Examples](https://observablehq.com/@d3/d3-bin)

Returns the number of bins according to [Scott’s normal reference rule](https://en.wikipedia.org/wiki/Histogram#Mathematical\_definition); the input _values_ must be numbers.

[#](./#thresholdSturges) d3.thresholdSturges(_values_) · [Source](https://github.com/d3/d3-array/blob/main/src/threshold/sturges.js), [Examples](https://observablehq.com/@d3/d3-bin)

Returns the number of bins according to [Sturges’ formula](https://en.wikipedia.org/wiki/Histogram#Mathematical\_definition); the input _values_ must be numbers.

You may also implement your own threshold generator taking three arguments: the array of input [_values_](./#bin\_value) derived from the data, and the [observable domain](./#bin\_domain) represented as _min_ and _max_. The generator may then return either the array of numeric thresholds or the _count_ of bins; in the latter case the domain is divided uniformly into approximately _count_ bins; see [ticks](./#ticks).

For instance, when binning date values, you might want to use the ticks from a time scale ([Example](https://observablehq.com/@d3/d3-bin-time-thresholds)).

### Interning

[#](./#InternMap) new d3.InternMap(\[_iterable_]\[, _key_]) · [Source](https://github.com/mbostock/internmap/blob/main/src/index.js), [Examples](https://observablehq.com/d/d4c5f6ad343866b9)\
[#](./#InternSet) new d3.InternSet(\[_iterable_]\[, _key_]) · [Source](https://github.com/mbostock/internmap/blob/main/src/index.js), [Examples](https://observablehq.com/d/d4c5f6ad343866b9)

The [InternMap and InternSet](https://github.com/mbostock/internmap) classes extend the native JavaScript Map and Set classes, respectively, allowing Dates and other non-primitive keys by bypassing the [SameValueZero algorithm](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Equality\_comparisons\_and\_sameness) when determining key equality. d3.group, d3.rollup and d3.index use an InternMap rather than a native Map. These two classes are exported for convenience.
